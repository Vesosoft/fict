<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Veso's PGN Viewer - –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª–µ–Ω</title>
<style>
  body { background: #121212; color: #eee; font-family: sans-serif; padding: 20px; }
  textarea { width: 100%; height: 150px; background: #1e1e1e; color: #f0f0f0; padding: 10px; border: 1px solid #444; font-family: monospace; }
  button { margin-top: 10px; margin-right: 10px; padding: 10px 15px; font-size: 16px; background: #333; color: #fff; border: none; border-radius: 5px; cursor: pointer; }
  button:hover { background: #555; }
  #board { width: 400px; margin-top: 20px; }
  /* –ú–∏–Ω–∏–º–∞–ª–µ–Ω —Å—Ç–∏–ª –∑–∞ –¥—ä—Å–∫–∞ */
  .chessboard { width: 400px; height: 400px; margin: 20px 0; background: linear-gradient(45deg, #769656 25%, #769656 75%, #eeeed2 75%, #eeeed2 100%); background-size: 80px 80px; position: relative; }
  .square { width: 50px; height: 50px; float: left; }
  .square.light { background: #eeeed2; }
  .square.dark { background: #769656; }
  .piece { position: absolute; width: 50px; height: 50px; background-size: contain; background-repeat: no-repeat; pointer-events: none; }
</style>
</head>
<body>

<h2>Veso's PGN Viewer ü§† (–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª–µ–Ω)</h2>

<textarea id="pgn" placeholder="–ü–æ—Å—Ç–∞–≤–∏ —Ç—É–∫ PGN –ø–∞—Ä—Ç–∏—è—Ç–∞ —Å–∏..."></textarea><br />
<button id="loadBtn">–ó–∞—Ä–µ–¥–∏ –ø–∞—Ä—Ç–∏—è—Ç–∞</button>
<button id="shareBtn">–°–ø–æ–¥–µ–ª–∏ –≤—ä–≤ Facebook</button>

<div id="board"></div>

<script>
// –ú–∏–Ω–∏–º–∞–ª–Ω–∞ —à–∞—Ö–º–∞—Ç–Ω–∞ –¥—ä—Å–∫–∞ (–±–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
// –®–∞—Ö–º–∞—Ç–Ω–∏ —Ñ–∏–≥—É—Ä–∏ –≤ Unicode
const piecesUnicode = {
  P: "‚ôô", N: "‚ôò", B: "‚ôó", R: "‚ôñ", Q: "‚ôï", K: "‚ôî",
  p: "‚ôü", n: "‚ôû", b: "‚ôù", r: "‚ôú", q: "‚ôõ", k: "‚ôö"
};

// –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ 8x8 –¥—ä—Å–∫–∞
function createBoard() {
  const board = document.getElementById('board');
  board.innerHTML = '';
  board.className = 'chessboard';
  for(let rank=8; rank>=1; rank--) {
    for(let file=1; file<=8; file++) {
      const square = document.createElement('div');
      square.className = 'square ' + ((rank + file) % 2 === 0 ? 'light' : 'dark');
      square.id = `square-${file}${rank}`;
      board.appendChild(square);
    }
  }
}

// –ü–æ–∫–∞–∑–≤–∞ —Ñ–∏–≥—É—Ä–∏ —Å–ø–æ—Ä–µ–¥ –ø–æ–∑–∏—Ü–∏—è –≤ FEN
function renderPosition(fen) {
  const board = document.getElementById('board');
  // –ü—Ä–µ–º–∞—Ö–≤–∞ —Å—Ç–∞—Ä–∏ —Ñ–∏–≥—É—Ä–∏
  [...board.querySelectorAll('.piece')].forEach(el => el.remove());

  const parts = fen.split(' ');
  if(parts.length < 1) return;
  const rows = parts[0].split('/');
  if(rows.length !== 8) return;

  for(let r=0; r<8; r++) {
    let file = 1;
    for(const ch of rows[r]) {
      if(!isNaN(ch)) {
        file += parseInt(ch);
      } else {
        const piece = document.createElement('div');
        piece.className = 'piece';
        piece.style.top = `${(7 - r) * 50}px`;
        piece.style.left = `${(file - 1) * 50}px`;
        piece.textContent = piecesUnicode[ch] || '';
        board.appendChild(piece);
        file++;
      }
    }
  }
}

// –ü—Ä–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞ –∏–≥—Ä–∞
// –¢—É–∫ –Ω—è–º–∞ –ø—ä–ª–Ω–∞ –ª–æ–≥–∏–∫–∞ –∑–∞ —à–∞—Ö–º–∞—Ç, —Å–∞–º–æ –∑–∞—Ä–µ–∂–¥–∞–º–µ –ø–∞—Ä—Ç–∏—è—Ç–∞ –æ—Ç PGN –∏ –ø–æ–∫–∞–∑–≤–∞–º–µ –ø–æ–∑–∏—Ü–∏—è—Ç–∞ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—è —Ö–æ–¥

// –ó–∞—Ä–µ–∂–¥–∞–º–µ PGN –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–º–µ –≤ FEN —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ minimal Chess.js port
// –í–º–µ—Å—Ç–æ –¥–∞ –ø–æ–ª–∑–≤–∞–º–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, —â–µ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –º–Ω–æ–≥–æ –æ–ø—Ä–æ—Å—Ç–µ–Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –∑–∞ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –Ω–∞—á–∞–ª–Ω–∞ –ø–æ–∑–∏—Ü–∏—è

// –ó–∞ —Ü–µ–ª–∏—Ç–µ –Ω–∞ –¥–µ–º–æ—Ç–æ: –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑–≤–∞–º–µ –Ω–∞—á–∞–ª–Ω–∞ –ø–æ–∑–∏—Ü–∏—è, –∞ –∞–∫–æ PGN –Ω–µ –µ –ø—Ä–∞–∑–µ–Ω, –ø–æ–∫–∞–∑–≤–∞–º–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–∑–∏—Ü–∏—è —Å–ª–µ–¥ –ø—ä—Ä–≤–∏—è —Ö–æ–¥ (hardcoded)

document.getElementById('loadBtn').onclick = () => {
  const pgn = document.getElementById('pgn').value.trim();
  if(!pgn) {
    alert('–ü–æ—Å—Ç–∞–≤–∏ PGN, –º–æ–ª—è!');
    return;
  }
  // –ó–∞ –ø—Ä–∏–º–µ—Ä: –∞–∫–æ PGN —Å—ä–¥—ä—Ä–∂–∞ —Ö–æ–¥ 1.e4 –ø–æ–∫–∞–∑–≤–∞–º–µ —Å—ä–æ—Ç–≤–µ—Ç–Ω–∞—Ç–∞ –ø–æ–∑–∏—Ü–∏—è (—Ç–≤—ä—Ä–¥–æ –∫–æ–¥–∏—Ä–∞–Ω–æ)
  if(pgn.includes('1.e4')) {
    renderPosition('rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq - 0 1');
  } else {
    // –ü–æ–∫–∞–∑–≤–∞–º–µ –Ω–∞—á–∞–ª–Ω–∞ –ø–æ–∑–∏—Ü–∏—è
    renderPosition('rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1');
  }
};

document.getElementById('shareBtn').onclick = (e) => {
  e.preventDefault();
  const url = encodeURIComponent(window.location.href);
  window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '', 'width=600,height=400');
};

// –°—ä–∑–¥–∞–≤–∞–º–µ –¥—ä—Å–∫–∞—Ç–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ
createBoard();
renderPosition('rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1');
</script>

</body>
</html>
