<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Veso's PGN Viewer</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background-color: #f5f5f5;
  }
  #board {
    width: 400px;
    margin-bottom: 10px;
  }
  #pgn {
    width: 100%;
    height: 120px;
    margin-top: 10px;
    font-family: monospace;
  }
  #controls button, #shareBtn, #copyLinkBtn {
    margin-right: 5px;
    padding: 5px 10px;
    cursor: pointer;
  }
  .info {
    background: #e0f0ff;
    padding: 10px;
    border: 1px solid #b0d4f1;
    margin-bottom: 10px;
  }
</style>
<link rel="stylesheet" href="https://unpkg.com/chessboardjs@1.0.0/www/css/chessboard-1.0.0.min.css" />
</head>
<body>

<h2>Veso's PGN Viewer ü§†üíô</h2>

<div class="info">
  üìù –ü–æ—Å—Ç–∞–≤–µ—Ç–µ —Ç—É–∫ —Å–≤–æ—è —à–∞—Ö–º–∞—Ç–µ–Ω –∑–∞–ø–∏—Å (PGN) ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–∞—Ç–∞ —Å–∏ –ø–∞—Ä—Ç–∏—è –æ—Ç –æ–Ω–ª–∞–π–Ω –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞.
</div>

<div id="board"></div>

<textarea id="pgn" placeholder="–ü–æ—Å—Ç–∞–≤–∏ —Ç—É–∫ —Å–≤–æ—è—Ç–∞ PGN –ø–∞—Ä—Ç–∏—è..." spellcheck="false"></textarea>

<div id="controls">
  <button id="startBtn">–ù–∞—á–∞–ª–æ</button>
  <button id="prevBtn">–ù–∞–∑–∞–¥</button>
  <button id="nextBtn">–ù–∞–ø—Ä–µ–¥</button>
  <button id="endBtn">–ö—Ä–∞–π</button>
  <button id="copyLinkBtn">–ö–æ–ø–∏—Ä–∞–π –ª–∏–Ω–∫–∞</button>
  <button id="shareBtn">–°–ø–æ–¥–µ–ª–∏ –≤—ä–≤ Facebook</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/1.0.0/chess.min.js"></script>
<script src="https://unpkg.com/chessboardjs@1.0.0/www/js/chessboard-1.0.0.min.js"></script>
<script>
  const board = Chessboard('board', {
    draggable: false,
    position: 'start',
  });

  const chess = new Chess();
  let moves = [];
  let currentMoveIndex = 0;

  function loadPGN() {
    const pgnText = document.getElementById('pgn').value;
    const loaded = chess.load_pgn(pgnText);
    if (!loaded) {
      alert('–ù–µ–≤–∞–ª–∏–¥–µ–Ω PGN –∑–∞–ø–∏—Å!');
      return false;
    }
    moves = chess.history();
    currentMoveIndex = 0;
    board.position(chess.fen());
    return true;
  }

  function moveTo(index) {
    chess.reset();
    for (let i = 0; i < index; i++) {
      chess.move(moves[i]);
    }
    board.position(chess.fen());
    currentMoveIndex = index;
  }

  function resetGame() {
    if (!loadPGN()) return;
    board.position(chess.fen());
  }

  function nextMove() {
    if (currentMoveIndex < moves.length) {
      chess.move(moves[currentMoveIndex]);
      currentMoveIndex++;
      board.position(chess.fen());
    }
  }

  function prevMove() {
    if (currentMoveIndex > 0) {
      moveTo(currentMoveIndex - 1);
    }
  }

  document.getElementById('startBtn').addEventListener('click', resetGame);
  document.getElementById('endBtn').addEventListener('click', () => {
    if (!loadPGN()) return;
    moveTo(moves.length);
  });
  document.getElementById('nextBtn').addEventListener('click', nextMove);
  document.getElementById('prevBtn').addEventListener('click', prevMove);

  document.getElementById('copyLinkBtn').addEventListener('click', () => {
    navigator.clipboard.writeText(window.location.href).then(() => {
      alert('–õ–∏–Ω–∫—ä—Ç –µ –∫–æ–ø–∏—Ä–∞–Ω!');
    });
  });

  document.getElementById('shareBtn').addEventListener('click', () => {
    const url = encodeURIComponent